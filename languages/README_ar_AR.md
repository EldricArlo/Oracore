<div align="center" dir="rtl">
  <img src="../src/media/icon-256.png" alt="Oracipher Icon" width="128">
  <h1 style="border-bottom: none;">Oracipher Core</h1>

# ููุชุจุฉ ููุงุฉ ุชุดููุฑ ูุฌูู ุนุงููุฉ ุงูุฃูุงู

| ุงูุจูุงุก | ุงูุชุฑุฎูุต | ุงููุบุฉ | ุงูุงุนุชูุงุฏูุงุช |
| :---: | :---: | :---: | :---: |
| ![Build Status](https://img.shields.io/badge/build-passing-brightgreen) | ![License](https://img.shields.io/badge/license-Dual--Licensed-blue) | ![Language](https://img.shields.io/badge/language-C11-purple) | ![Libsodium](https://img.shields.io/badge/libsodium-v1.0.18+-brightgreen) ![OpenSSL](https://img.shields.io/badge/OpenSSL-v3.0+-0075A8) ![Libcurl](https://img.shields.io/badge/libcurl-v7.68+-E5522D) |

</div>

<div dir="rtl">

## 1. ๐ ุฑุคูุฉ ุงููุดุฑูุน ูุงููุจุงุฏุฆ ุงูุฃุณุงุณูุฉ

ูุฐุง ุงููุดุฑูุน ูู ููุชุจุฉ ููุงุฉ ุชุดููุฑ ูุฌูู ูุชูุฏูุฉุ ุชู ุชูููุฐูุง ุจุงุณุชุฎุฏุงู ูุนูุงุฑ C11 ูุชุฑูุฒ ุจุดูู ุฎุงุต ุนูู ุงูุฃูุงู. ููุฏู ุงููุดุฑูุน ุฅูู ุชูุฏูู ูุฎุทุท ุนููู ูููุฎุชุจูุฑ ููุถุญ ููููุฉ ุฏูุฌ ููุชุจุงุช ุงูุชุดููุฑ ุงูุฑุงุฆุฏุฉ ูู ุงูุตูุงุนุฉ (**libsodium**, **OpenSSL**, **libcurl**) ูู ุญู ุชุดููุฑ ูุชูุงูู (end-to-end) ููู ูููุซูู ูุณูู ุงูุงุณุชุฎุฏุงู.

ูุชุจุน ุชุตููููุง ูุจุงุฏุฆ ุงูุฃูุงู ุงูุฃุณุงุณูุฉ ุงูุชุงููุฉ:

*   ๐ฅธ **ุงุฎุชูุงุฑ ุนูู ุชุดููุฑ ุญุฏูุซ ูููุฏูููู:** ูุง ุชูู ุฃุจุฏูุง ุจุชูููุฐ ุฎูุงุฑุฒููุงุช ุงูุชุดููุฑ ุจููุณู. ุงุณุชุฎุฏู ููุท ุงูุฃุฏูุงุช ุงูุฃูููุฉ (primitives) ููุชุดููุฑ ุงูุญุฏูุซุฉ ูุงููุนุชุฑู ุจูุง ูู ูุจู ุงููุฌุชูุน ูุงูููุงููุฉ ููุฌูุงุช ุงููููุงุช ุงูุฌุงูุจูุฉ.
*   ๐ค **ุงูุฏูุงุน ูู ุงูุนูู:** ูุง ูุนุชูุฏ ุงูุฃูุงู ุนูู ุทุจูุฉ ูุงุญุฏุฉ. ูุชู ุจูุงุก ุงูุฏูุงุน ุนูู ูุณุชููุงุช ูุชุนุฏุฏุฉุ ุจุฏุกูุง ูู ุฅุฏุงุฑุฉ ุงูุฐุงูุฑุฉ ูุชุตููู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API) ูุตูููุง ุฅูู ุชุฏูู ุงูุจุฑูุชูููู.
*   ๐ **ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ ุงูุขููุฉ ู"ุงูุฅุบูุงู ุนูุฏ ุงููุดู" (Fail-Closed):** ูุฌุจ ุฃู ูููู ุงูุณููู ุงูุงูุชุฑุงุถู ูููุธุงู ุขูููุง. ุนูุฏ ููุงุฌูุฉ ุญุงูุฉ ุบูุฑ ูุคูุฏุฉ (ูุซู ุนุฏู ุงููุฏุฑุฉ ุนูู ุงูุชุญูู ูู ุญุงูุฉ ุฅูุบุงุก ุงูุดูุงุฏุฉ)ุ ูุฌุจ ุนูู ุงููุธุงู ุฃู ูุฎุชุงุฑ ุงููุดู ูุฅููุงุก ุงูุนูููุฉ (Fail-Closed) ุจุฏูุงู ูู ุงููุชุงุจุนุฉ.
*   ๐ซฅ **ุชูููู ุชุนุฑุถ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ:** ูุฌุจ ุงูุชุญูู ุจุฏูุฉ ูู ุฏูุฑุฉ ุญูุงุฉ ููุทุงู ููุฏุฉ ุจูุงุก ุงูุจูุงูุงุช ุงูุญูููุฉ ูุซู ุงูููุงุชูุญ ุงูุฎุงุตุฉ ูู ุงูุฐุงูุฑุฉุ ูุญุตุฑูุง ูู ุงูุญุฏ ุงูุฃุฏูู ุงูุถุฑูุฑู ููุบุงูุฉ.

## 2. ๐ฅฒ ุงูููุฒุงุช ุงูุฃุณุงุณูุฉ

*   ๐ฎ **ูููุฐุฌ ุชุดููุฑ ูุฌูู ููู:**
    *   **ุงูุชุดููุฑ ุงููุชูุงุซู:** ูููุฑ ุชุดููุฑูุง ูุชุฏูููุง ููุซููุง (AEAD) ูุนุชูุฏ ุนูู **XChaCha20-Poly1305** ููุจูุงูุงุช ุงููุจูุฑุฉุ ูุชุดููุฑ AEAD ููุฑุฉ ูุงุญุฏุฉ ููุจูุงูุงุช ุงูุตุบูุฑุฉ.
    *   **ุงูุชุดููุฑ ุบูุฑ ุงููุชูุงุซู:** ูุณุชุฎุฏู **X25519** (ุงููุจูู ุนูู Curve25519) ูุชุบููู ููุชุงุญ ุงูุฌูุณุฉ ุงููุชูุงุซูุ ููุง ูุถูู ุฃู ุงููุณุชูู ุงูููุตูุฏ ููุท ูู ูู ููููู ูู ุชุดููุฑู.

*   ๐ซจ **ุญุฒูุฉ ุฃุฏูุงุช ุชุดููุฑ ุญุฏูุซุฉ:**
    *   **ุงุดุชูุงู ุงูููุงุชูุญ:** ูุนุชูุฏ **Argon2id**ุ ููู ุงููุงุฆุฒ ูู ูุณุงุจูุฉ ุชุฌุฒุฆุฉ ูููุงุช ุงููุฑูุฑุ ูุงูุฐู ููุงูู ุจูุนุงููุฉ ูุฌูุงุช ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ูุงูุฏูุงุฆุฑ ุงููุชูุงููุฉ ูุญุฏุฏุฉ ุงูุชุทุจูู (ASIC).
    *   **ุงูุชูููุน ุงูุฑููู:** ูุณุชุฎุฏู **Ed25519**ุ ุงูุฐู ูููุฑ ูุฏุฑุงุช ุชูููุน ุฑููู ุนุงููุฉ ุงูุณุฑุนุฉ ูุงูุฃูุงู.
    *   **ุชูุญูุฏ ุงูููุงุชูุญ:** ูุณุชููุฏ ุจุฐูุงุก ูู ุฎุงุตูุฉ ุชุญููู ููุงุชูุญ Ed25519 ุจุฃูุงู ุฅูู ููุงุชูุญ X25519ุ ููุง ูุณูุญ ูุฒูุฌ ูุงุญุฏ ูู ุงูููุงุชูุญ ุงูุฑุฆูุณูุฉ ุจุชูุจูุฉ ุงุญุชูุงุฌุงุช ุงูุชูููุน ูุงูุชุดููุฑ ูุนูุง.

*   ๐ **ุฏุนู ุดุงูู ููุจููุฉ ุงูุชุญุชูุฉ ููููุงุชูุญ ุงูุนุงูุฉ (PKI):**
    *   **ุฏูุฑุฉ ุญูุงุฉ ุงูุดูุงุฏุฉ:** ูุฏุนู ุฅูุดุงุก ุทูุจุงุช ุชูููุน ุงูุดูุงุฏุงุช (CSR) ุงููุชูุงููุฉ ูุน ูุนูุงุฑ X.509 v3.
    *   **ุชุญูู ุตุงุฑู ูู ุงูุดูุงุฏุงุช:** ูููุฑ ุนูููุฉ ููุญุฏุฉ ููุชุญูู ูู ุงูุดูุงุฏุงุชุ ุชุดูู ุณูุณูุฉ ุงูุซูุฉุ ููุชุฑุฉ ุงูุตูุงุญูุฉุ ููุทุงุจูุฉ ุงูููุถูุน.
    *   **ูุญุต ุฅูุฒุงูู ููุฅูุบุงุก (OCSP):** ูุชุถูู ูุญุตูุง ุตุงุฑููุง ูุฏูุฌูุง ูุจุฑูุชูููู ุญุงูุฉ ุงูุดูุงุฏุงุช ุนุจุฑ ุงูุฅูุชุฑูุช (OCSP) ูุน ุณูุงุณุฉ "ุงูุฅุบูุงู ุนูุฏ ุงููุดู"ุ ููุง ูููู ุงูุนูููุฉ ููุฑูุง ุฅุฐุง ูู ูุชู ุงูุชุฃูุฏ ูู ุตูุงุญูุฉ ุงูุดูุงุฏุฉ.

*   ๐ง **ุฃูุงู ุฐุงูุฑุฉ ูููุน:**
    *   ูููุฑ ูุธุงุฆู ุงูุฐุงูุฑุฉ ุงูุขููุฉ ูู `libsodium` ุนุจุฑ ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุนุงูุฉุ ููุง ูุณูุญ ููุนููุงุก ุจุงูุชุนุงูู ูุน ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ (ูุซู ููุงุชูุญ ุงูุฌูุณุฉ) ุจุฃูุงู.
    *   ุฌููุน ุงูููุงุชูุญ ุงูุฎุงุตุฉ ุงูุฏุงุฎููุฉ ูุฎุฒูุฉ ูู ุฐุงูุฑุฉ ููููุฉุ **ููุง ูููุน ูุธุงู ุงูุชุดุบูู ูู ูุจุงุฏูุชูุง ุฅูู ุงููุฑุต**ุ ููุชู ูุณุญูุง ุจุฃูุงู ูุจู ุชุญุฑูุฑูุง.

*   ๐ตโ๐ซ **ููุงุฑุณุงุช ููุฏุณูุฉ ุนุงููุฉ ุงูุฌูุฏุฉ:**
    *   **ุญุฏูุฏ ูุงุถุญุฉ ููุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (API):** ูููุฑ ููู ุชุฑููุณุฉ ุนุงููุง ููุญุฏูุง `hsc_kernel.h`ุ ูุณุชุฎุฏู ูุคุดุฑุงุช ุบูุฑ ุดูุงูุฉ (opaque pointers) ูุชุบููู ุฌููุน ุชูุงุตูู ุงูุชูููุฐ ุงูุฏุงุฎููุฉุ ููุง ูุญูู ุชูุงุณููุง ุนุงูููุง ูุชุฑุงุจุทูุง ููุฎูุถูุง.
    *   **ููุฎุชุจูุฑ ุจูุญุฏุงุช ุงุฎุชุจุงุฑ:** ูุชุถูู ูุฌููุนุฉ ูู ุงุฎุชุจุงุฑุงุช ุงููุญุฏุงุช ุงูุชู ุชุบุทู ูุธุงุฆู ุงูุชุดููุฑ ุงูุฃุณุงุณูุฉ ูุงูุจููุฉ ุงูุชุญุชูุฉ ููููุงุชูุญ ุงูุนุงูุฉุ ููุง ูุถูู ุตุญุฉ ูููุซูููุฉ ุงูููุฏ.
    *   **ุชูุซูู ูุฃูุซูุฉ ูุงููุฉ:** ูููุฑ ููู `README.md` ููุตูุ ุจุงูุฅุถุงูุฉ ุฅูู ุจุฑูุงูุฌ ุชุฌุฑูุจู ูุฃุฏุงุฉ ุณุทุฑ ุฃูุงูุฑ ุฌุงูุฒุฉ ููุชุดุบูู.

## 3. ๐ค ูููู ุงููุดุฑูุน

ูุชุจูู ุงููุดุฑูุน ูููู ูุฌูุฏุงุช ูุงุถุญูุง ููุชุนุฏุฏ ุงูุทุจูุงุช ูุชุญููู ูุตู ุงูุงูุชูุงูุงุช.

```
.
โโโ include/
โ   โโโ hsc_kernel.h      # [ุงูููุงุฉ] ููู ุงูุชุฑููุณุฉ ุงูุนุงู ุงููุญูุฏ ููุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช
โโโ src/                  # ุงูููุฏ ุงููุตุฏุฑู
โ   โโโ common/           # ุงููุญุฏุงุช ุงูุฏุงุฎููุฉ ุงููุดุชุฑูุฉ (ุฐุงูุฑุฉ ุขููุฉุ ููุงุตูุงุช ุฃูุงู)
โ   โโโ core_crypto/      # ูุญุฏุงุช ุงูุชุดููุฑ ุงูุฃุณุงุณูุฉ ุงูุฏุงุฎููุฉ (ูุบููู ูู libsodium)
โ   โโโ pki/              # ูุญุฏุงุช PKI ุงูุฏุงุฎููุฉ (ูุบูููุงุช ูู OpenSSL, libcurl)
โ   โโโ hsc_kernel.c      # [ุงูููุงุฉ] ุชูููุฐ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุนุงูุฉ
โ   โโโ main.c            # ูุซุงู ุนูู ุงุณุชุฎุฏุงู API: ุจุฑูุงูุฌ ุชุฌุฑูุจู ูุณูุฑ ุงูุนูู ุงููุชูุงูู
โ   โโโ cli.c             # ูุซุงู ุนูู ุงุณุชุฎุฏุงู API: ุฃุฏุงุฉ ุณุทุฑ ุฃูุงูุฑ ูููุฉ
โโโ tests/                # ุงุฎุชุจุงุฑุงุช ุงููุญุฏุงุช
โ   โโโ test_*.c          # ุงุฎุชุจุงุฑุงุช ูุญุฏุงุช ููุฎุชูู ุงููุญุฏุงุช
โ   โโโ test_helpers.h/.c # ุฏูุงู ูุณุงุนุฏุฉ ููุงุฎุชุจุงุฑ
โโโ Makefile              # ุณูุฑุจุช ููุจูุงุก ูุฅุฏุงุฑุฉ ุงูููุงู
โโโ README.md             # ุชูุซูู ูุฐุง ุงููุดุฑูุน
```

## 4. ๐คฅ ุฏููู ุงูุจุฏุก ุงูุณุฑูุน

### 4.1. ุงูุงุนุชูุงุฏูุงุช ูุงููุชุทูุจุงุช

*   **ุฃุฏูุงุช ุงูุจูุงุก:** `make`
*   **ูุชุฑุฌู C:** `gcc` ุฃู `clang` (ูุฏุนู ูุนูุงุฑ C11)
*   **libsodium:** (`libsodium-dev`)
*   **OpenSSL:** ูููุตุญ ุจุงูุฅุตุฏุงุฑ **v3.0** ุฃู ุฃุญุฏุซ (`libssl-dev`)
*   **libcurl:** (`libcurl4-openssl-dev`)

**ููุชุซุจูุช ุจุฃูุฑ ูุงุญุฏ ุนูู Debian/Ubuntu:**
```bash
sudo apt-get update
sudo apt-get install build-essential libsodium-dev libssl-dev libcurl4-openssl-dev
```

### 4.2. ุงูุชุฑุฌูุฉ ูุงูุงุฎุชุจุงุฑ

1.  **ุชุฑุฌูุฉ ุฌููุน ุงูุฃูุฏุงู (ุงูููุชุจุฉุ ุงูุจุฑูุงูุฌ ุงูุชุฌุฑูุจูุ CLIุ ุงูุงุฎุชุจุงุฑุงุช):**
    ```bash
    make all
    ```

2.  **ุชุดุบูู ุงุฎุชุจุงุฑุงุช ุงููุญุฏุงุช (ุฎุทูุฉ ุญุงุณูุฉ):**
    ```bash
    make run-tests
    ```
    > ๐ **ููุงุญุธุฉ ุญูู ุงูุณููู ุงููุชููุน ูุงุฎุชุจุงุฑ OCSP**
    >
    > ุฅุญุฏู ุญุงูุงุช ุงูุงุฎุชุจุงุฑ ูู `test_pki_verification` ุณุชุณุชุฎุฏู ุนูุฏูุง ุดูุงุฏุฉ ุชุดูุฑ ุฅูู ุฎุงุฏู OCSP ุบูุฑ ุตุงูุญ ููุชุญูู. ูุธุฑูุง ูุฃู ุทูุจ ุงูุดุจูุฉ ุณููุดู ุญุชููุงุ **ูุฌุจ** ุนูู ุงูุฏุงูุฉ `hsc_verify_user_certificate` ุฃู ุชุนูุฏ ุงููููุฉ `-4` ููุฅุดุงุฑุฉ ุฅูู ูุดู ุงูุชุญูู ูู ุญุงูุฉ ุงูุฅูุบุงุก. ุณูุคูุฏ ููุฏ ุงูุงุฎุชุจุงุฑ ุฃู ุงููููุฉ ุงููุนุงุฏุฉ ูู ุจุงููุนู `-4`ุ ููุง ูุซุจุช ุฃู ุขููุฉ ุงูุฃูุงู "ุงูุฅุบูุงู ุนูุฏ ุงููุดู" ุชุนูู ุจุดูู ุตุญูุญ.

3.  **ุชุดุบูู ุงูุจุฑูุงูุฌ ุงูุชุฌุฑูุจู:**
    ```bash
    ./bin/hsc_demo
    ```

4.  **ุชุดุบูู ุฃุฏุงุฉ ุณุทุฑ ุงูุฃูุงูุฑ:**
    ```bash
    ./bin/hsc_cli --help
    ```

5.  **ุชูุธูู ูููุงุช ุงูุจูุงุก:**
    ```bash
    make clean
    ```

## 5. โบ๏ธ ุฏููู ุงูุงุณุชุฎุฏุงู

### 5.1. ูุฃุฏุงุฉ ุณุทุฑ ุฃูุงูุฑ (`hsc_cli`)

`hsc_cli` ูู ุฃุฏุงุฉ ุณุทุฑ ุฃูุงูุฑ ูุงููุฉ ุงูููุฒุงุช **ุชุฏุนู ุชุฑุชูุจูุง ูุฑููุง ูููุนููุงุช**ุ ูุชูุณุชุฎุฏู ูุชูููุฐ ุฌููุน ุนูููุงุช ุงูุชุดููุฑ ู PKI ุงูุฃุณุงุณูุฉ.

**ูุซุงู ุนูู ุณูุฑ ุนูู ูุงูู: ุชููู ุฃููุณ ุจุชุดููุฑ ููู ูุฅุฑุณุงูู ุจุฃูุงู ุฅูู ุจูุจ**

1.  **๐ (ููุง ุงูุทุฑููู) ุฅูุดุงุก ุฃุฒูุงุฌ ุงูููุงุชูุญ ุงูุฑุฆูุณูุฉ:**
    ```bash
    ./bin/hsc_cli gen-keypair alice
    ./bin/hsc_cli gen-keypair bob
    ```

2.  **โบ๏ธ (ููุง ุงูุทุฑููู) ุฅูุดุงุก CSR ูุงูุญุตูู ุนูู ุงูุดูุงุฏุงุช:** (ููุชุฑุถ ููุง ุฃู ููุฆุฉ ุงูุชุตุฏูู ูุฏ ุฃุตุฏุฑุช `alice.pem` ู `bob.pem`)
    ```bash
    ./bin/hsc_cli gen-csr alice.key "alice@example.com"
    # (ุฃุฑุณู alice.csr ุฅูู ููุฆุฉ ุงูุชุตุฏูู ููุญุตูู ุนูู alice.pem)
    ```

3.  **๐คจ (ุฃููุณ) ุงูุชุญูู ูู ุดูุงุฏุฉ ุจูุจ:** (ุจุงูุชุฑุงุถ ุฃู `ca.pem` ูู ุดูุงุฏุฉ ููุฆุฉ ุงูุชุตุฏูู ุงูุฌุฐุฑูุฉ ุงูููุซููุฉ)
    ```bash
    ./bin/hsc_cli verify-cert bob.pem --ca ca.pem --user "bob@example.com"
    ```
    > **ูุตูุญุฉ:** ุงูุฎูุงุฑุงุช ุงูุชู ููุง ููู (ูุซู `--ca` ู `--user`) ูููู ุงูุขู ุฅุฏุฑุงุฌูุง ุจุฃู ุชุฑุชูุจ.

4.  **๐ (ุฃููุณ) ุชุดููุฑ ููู ูุจูุจ:**
    ```bash
    echo "This is top secret information." > secret.txt
    ./bin/hsc_cli encrypt secret.txt --to bob.pem --from alice.key
    ```
    ุงูุขู ูููู ูุฃููุณ ุฅุฑุณุงู `secret.hsc` ูุดูุงุฏุชูุง ุงูุฎุงุตุฉ `alice.pem` ุฅูู ุจูุจ.

5.  **๐ (ุจูุจ) ูู ุชุดููุฑ ุงูููู ุจุนุฏ ุงุณุชูุงูู:**
    ```bash
    # ูููู ูุจูุจ ุฃูุถูุง ุชุจุฏูู ุชุฑุชูุจ --from ู --to
    ./bin/hsc_cli decrypt secret.hsc --to bob.key --from alice.pem
    cat secret.decrypted
    ```

### 5.2. ูุฏูุฌ ููุชุจุฉ ูู ูุดุฑูุนู

ุงูููู `src/main.c` ูู ูุซุงู ููุชุงุฒ ุนูู ุงูุชูุงูู. ูููุง ููู ุงูุชุฏูู ุงููููุฐุฌู ูุงุณุชุฏุนุงุกุงุช ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช:

1.  **ุงูุชููุฆุฉ ุงูุนุงูุฉ:** ุนูุฏ ุจุฏุก ุชุดุบูู ุงูุจุฑูุงูุฌุ ุงุณุชุฏุนู `hsc_init()`.
    ```c
    #include "hsc_kernel.h"
    
    int main() {
        if (hsc_init() != 0) {
            // ุงูุชุนุงูู ูุน ุฎุทุฃ ูุงุฏุญ
        }
        // ... ุงูููุฏ ุงูุฎุงุต ุจู ...
        hsc_cleanup();
        return 0;
    }
    ```

2.  **ุงููุฑุณู (ุฃููุณ) ูููู ุจุชุดููุฑ ุงูุจูุงูุงุช:**
    ```c
    // 1. ุฅูุดุงุก ููุชุงุญ ุฌูุณุฉ ููุฑุฉ ูุงุญุฏุฉ
    unsigned char session_key[HSC_SESSION_KEY_BYTES];
    randombytes_buf(session_key, sizeof(session_key));

    // 2. ุชุดููุฑ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ููุชุงุญ ุงูุฌูุณุฉ ุนุจุฑ AEAD (ููุงุณุจ ููุจูุงูุงุช ุงูุตุบูุฑุฉ)
    const char* message = "Secret message";
    size_t enc_buf_size = strlen(message) + HSC_AEAD_NONCE_BYTES + HSC_AEAD_TAG_BYTES;
    unsigned char* encrypted_data = malloc(enc_buf_size);
    unsigned long long encrypted_data_len;
    hsc_aead_encrypt(encrypted_data, &encrypted_data_len, 
                     (const unsigned char*)message, strlen(message), session_key);

    // 3. ุงูุชุญูู ูู ุดูุงุฏุฉ ุงููุณุชูู (ุจูุจ)
    if (hsc_verify_user_certificate(bob_cert_pem, ca_pem, "bob@example.com") != 0) {
        // ุดูุงุฏุฉ ุบูุฑ ุตุงูุญุฉุ ูู ุจุงูุฅููุงู!
    }

    // 4. ุงุณุชุฎุฑุงุฌ ุงูููุชุงุญ ุงูุนุงู ูุจูุจ ูู ุดูุงุฏุชู
    unsigned char bob_pk[HSC_MASTER_PUBLIC_KEY_BYTES];
    hsc_extract_public_key_from_cert(bob_cert_pem, bob_pk);

    // 5. ุชุบููู ููุชุงุญ ุงูุฌูุณุฉ ุจุงุณุชุฎุฏุงู ููุชุงุญ ุจูุจ ุงูุนุงู ูููุชุงุญ ุฃููุณ ุงูุฎุงุต
    // (ุจุงูุชุฑุงุถ ุฃู alice_kp ูู hsc_master_key_pair* ุชู ุชุญูููู)
    unsigned char encapsulated_key[...]; size_t encapsulated_key_len;
    hsc_encapsulate_session_key(encapsulated_key, &encapsulated_key_len, 
                                session_key, sizeof(session_key),
                                bob_pk, alice_kp);
    
    // 6. ุฃุฑุณู encrypted_data ู encapsulated_key ุฅูู ุจูุจ
    ```

3.  **ุงููุณุชูู (ุจูุจ) ูููู ุจูู ุชุดููุฑ ุงูุจูุงูุงุช:**
    ```c
    // 1. ุงุณุชุฎุฑุงุฌ ุงูููุชุงุญ ุงูุนุงู ูููุฑุณู (ุฃููุณ) ูู ุดูุงุฏุชูุง
    unsigned char alice_pk[HSC_MASTER_PUBLIC_KEY_BYTES];
    hsc_extract_public_key_from_cert(alice_cert_pem, alice_pk);
    
    // 2. ูู ุชุบููู ููุชุงุญ ุงูุฌูุณุฉ ุจุงุณุชุฎุฏุงู ููุชุงุญ ุฃููุณ ุงูุนุงู ูููุชุงุญ ุจูุจ ุงูุฎุงุต
    // (ุจุงูุชุฑุงุถ ุฃู bob_kp ูู hsc_master_key_pair* ุชู ุชุญูููู)
    unsigned char* dec_session_key = hsc_secure_alloc(HSC_SESSION_KEY_BYTES);
    if (hsc_decapsulate_session_key(dec_session_key, encapsulated_key, enc_key_len,
                                    alice_pk, bob_kp) != 0) {
        // ูุดู ูู ุงูุชุบููู!
    }

    // 3. ูู ุชุดููุฑ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ููุชุงุญ ุงูุฌูุณุฉ ุงููุณุชุนุงุฏ
    unsigned char final_message[...]; unsigned long long final_len;
    if (hsc_aead_decrypt(final_message, &final_len,
                         encrypted_data, encrypted_data_len, dec_session_key) != 0) {
        // ูุดู ูู ุงูุชุดููุฑ! ุชู ุงูุชูุงุนุจ ุจุงูุจูุงูุงุช
    }

    // 4. ุญุฑุฑ ููุชุงุญ ุงูุฌูุณุฉ ุจุฃูุงู ุจุนุฏ ุงูุงุณุชุฎุฏุงู
    hsc_secure_free(dec_session_key);
    ```

## 6. ๐ถ ุชุญููู ูุนูู ููุจููุฉ ุงูุชูููุฉ

ุฌููุฑ ูุฐุง ุงููุดุฑูุน ูู ูููุฐุฌ ุงูุชุดููุฑ ุงููุฌูู (Hybrid Encryption)ุ ุงูุฐู ูุฌูุน ุจูู ูุฒุงูุง ุงูุชุดููุฑ ุบูุฑ ุงููุชูุงุซู ูุงูุชุดููุฑ ุงููุชูุงุซู ูุชุญููู ููู ุจูุงูุงุช ุขูู ููุนุงู.

**ูุฎุทุท ุชุฏูู ุงูุจูุงูุงุช ูุนูุงูุฉ ุงูููุงุชูุญ:**

```
ุงููุฑุณู (ุฃููุณ)                                           ุงููุณุชูู (ุจูุจ)
========================================================================
[ ุงูุจูุงูุงุช ุงูุฃุตููุฉ ] -> ุฅูุดุงุก [ููุชุงุญ ุงูุฌูุณุฉ]
                      |        |
(ุชุดููุฑ ูุชูุงุซู) <-------'        '-> (ุชุบููู ุบูุฑ ูุชูุงุซู) ุจุงุณุชุฎุฏุงู: ููุชุงุญ ุจูุจ ุงูุนุงูุ ููุชุงุญ ุฃููุณ ุงูุฎุงุต
     |                                    |
[ุงูุจูุงูุงุช ุงููุดูุฑุฉ]                     [ููุชุงุญ ุงูุฌูุณุฉ ุงููุบูู]
     |                                    |
     '----------------. .-----------------'
                      | |
                      v v
                  [ ุญุฒูุฉ ุงูููู ]
                       |
   ==================> | ููู ุนุจุฑ ุงูุดุจูุฉ/ุงููููุงุช =================>
                       |
                  [ ุญุฒูุฉ ุงูููู ]
                      | |
           .----------' '-------------.
           |                          |
[ููุชุงุญ ุงูุฌูุณุฉ ุงููุบูู]             [ุงูุจูุงูุงุช ุงููุดูุฑุฉ]
           |                          |
           v                          |
(ูู ุชุบููู ุบูุฑ ูุชูุงุซู) ุจุงุณุชุฎุฏุงู: ููุชุงุญ ุจูุจ ุงูุฎุงุตุ ููุชุงุญ ุฃููุณ ุงูุนุงู |
           |                          |
           v                          |
      [ููุชุงุญ ุงูุฌูุณุฉ ุงููุณุชุนุงุฏ] <--------$----' (ูู ุชุดููุฑ ูุชูุงุซู)
           |
           v
      [ ุงูุจูุงูุงุช ุงูุฃุตููุฉ ]
```

## 7. ๐ ุงูุฅุนุฏุงุฏุงุช ุงููุชูุฏูุฉ: ุชุนุฒูุฒ ุงูุฃูุงู ุนุจุฑ ูุชุบูุฑุงุช ุงูุจูุฆุฉ

ููุชููู ูุน ุงูุฃุฌูุฒุฉ ุงูุฃููู ููุชุทูุจุงุช ุงูุฃูุงู ุงููุณุชูุจููุฉ ุฏูู ุชุนุฏูู ุงูููุฏุ ูุฏุนู ูุฐุง ุงููุดุฑูุน **ุฒูุงุฏุฉ** ุงูููุฉ ุงูุญุงุณูุจูุฉ ูุฏุงูุฉ ุงุดุชูุงู ุงูููุงุชูุญ (Argon2id) ุนุจุฑ ูุชุบูุฑุงุช ุงูุจูุฆุฉ.

*   **`HSC_ARGON2_OPSLIMIT`**: ูุถุจุท ุนุฏุฏ ุฏูุฑุงุช ุงูุนูููุงุช (ุงูุญุณุงุจูุฉ) ูู Argon2id.
*   **`HSC_ARGON2_MEMLIMIT`**: ูุถุจุท ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ูู Argon2id (ุจุงูุจุงูุช).

**ููุงุญุธุฉ ุฃูุงู ูุงูุฉ:** ูููู ุงุณุชุฎุฏุงู ูุฐู ุงูููุฒุฉ **ููุท ูุฒูุงุฏุฉ ูุนููุงุช ุงูุฃูุงู**. ุฅุฐุง ูุงูุช ููู ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงููุนููุฉ ุฃูู ูู ุงูุญุฏ ุงูุฃุฏูู ููุฃูุงู ุงููุฏูุฌ ูู ุงููุดุฑูุนุ ุณูุชุฌุงูู ุงูุจุฑูุงูุฌ ุชููุงุฆููุง ูุฐู ุงูููู ุบูุฑ ุงูุขููุฉ ูููุฑุถ ุงุณุชุฎุฏุงู ุงูุญุฏ ุงูุฃุฏูู ุงููุฏูุฌ.

** ูุซุงู ุงุณุชุฎุฏุงู ุฌุฏูุฏ:**

```bash
# ูุซุงู: ุฒูุงุฏุฉ ุญุฏ ุงูุนูููุงุช ุฅูู 10 ูุญุฏ ุงูุฐุงูุฑุฉ ุฅูู 512 ููุฌุงุจุงูุช.
# ููุงุญุธุฉ: ูุฌุจ ุฃู ุชููู ูููุฉ HSC_ARGON2_MEMLIMIT ุจุงูุจุงูุช.
# 512 * 1024 * 1024 = 536870912 ุจุงูุช.
export HSC_ARGON2_OPSLIMIT=10
export HSC_ARGON2_MEMLIMIT=536870912

# ูู ุจุชุดุบูู ุงูุจุฑูุงูุฌ ูู ุจูุฆุฉ shell ุญูุซ ุชู ุชุนููู ูุชุบูุฑุงุช ุงูุจูุฆุฉ.
# ุณูุณุชุฎุฏู ุชููุงุฆููุง ูุฐู ุงููุนููุงุช ุงูุฃููู.
./bin/hsc_cli gen-keypair my_strong_key```

## 8. ๐ ุงููุฑุฌุน ุงูุฃุณุงุณู ููุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช (`include/hsc_kernel.h`)

### ุงูุชููุฆุฉ ูุงูุชูุธูู
| ุงูุฏุงูุฉ | ุงููุตู |
| :--- | :--- |
| `int hsc_init()` | **(ูุฌุจ ุงุณุชุฏุนุงุคูุง ุฃููุงู)** ุชููุฆุฉ ุงูููุชุจุฉ ุจุฃููููุง. |
| `void hsc_cleanup()` | ุชูุณุชุฏุนู ูุจู ุฎุฑูุฌ ุงูุจุฑูุงูุฌ ูุชุญุฑูุฑ ุงูููุงุฑุฏ ุงูุนุงูุฉ. |

### ุฅุฏุงุฑุฉ ุงูููุงุชูุญ
| ุงูุฏุงูุฉ | ุงููุตู |
| :--- | :--- |
| `hsc_master_key_pair* hsc_generate_master_key_pair()` | ุฅูุดุงุก ุฒูุฌ ุฌุฏูุฏ ูู ุงูููุงุชูุญ ุงูุฑุฆูุณูุฉ. |
| `hsc_master_key_pair* hsc_load_master_key_pair_from_private_key(...)` | ุชุญููู ููุชุงุญ ุฎุงุต ูู ููู. |
| `int hsc_save_master_key_pair(...)` | ุญูุธ ุฒูุฌ ุงูููุงุชูุญ ูู ููู. |
| `void hsc_free_master_key_pair(hsc_master_key_pair** kp)` | ุชุญุฑูุฑ ุฒูุฌ ุงูููุงุชูุญ ุงูุฑุฆูุณูุฉ ุจุฃูุงู. |

### PKI ูุงูุดูุงุฏุงุช
| ุงูุฏุงูุฉ | ุงููุตู |
| :--- | :--- |
| `int hsc_generate_csr(...)` | ุฅูุดุงุก ุทูุจ ุชูููุน ุดูุงุฏุฉ (CSR) ุจุตูุบุฉ PEM. |
| `int hsc_verify_user_certificate(...)` | **(ุฃุณุงุณูุฉ)** ุฅุฌุฑุงุก ุชุญูู ูุงูู ููุดูุงุฏุฉ (ุณูุณูุฉ ุงูุชูููุนุ ุงูุตูุงุญูุฉุ ุงูููุถูุนุ OCSP). |
| `int hsc_extract_public_key_from_cert(...)` | ุงุณุชุฎุฑุงุฌ ุงูููุชุงุญ ุงูุนุงู ูู ุดูุงุฏุฉ ุชู ุงูุชุญูู ูููุง. |

### ุชุบููู ุงูููุงุชูุญ (ุบูุฑ ูุชูุงุซู)
| ุงูุฏุงูุฉ | ุงููุตู |
| :--- | :--- |
| `int hsc_encapsulate_session_key(...)` | ุชุดููุฑ ููุชุงุญ ุฌูุณุฉ ุจุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุนุงู ูููุณุชูู. |
| `int hsc_decapsulate_session_key(...)` | ูู ุชุดููุฑ ููุชุงุญ ุฌูุณุฉ ุจุงุณุชุฎุฏุงู ุงูููุชุงุญ ุงูุฎุงุต ูููุณุชูู. |

### ุชุดููุฑ ุงูุจูุงูุงุช (ูุชูุงุซู)
| ุงูุฏุงูุฉ | ุงููุตู |
| :--- | :--- |
| `int hsc_aead_encrypt(...)` | ุชุดููุฑ ูุชูุซูู **ูุชูุฉ ุจูุงูุงุช ุตุบูุฑุฉ** ุจุงุณุชุฎุฏุงู AEAD. |
| `int hsc_aead_decrypt(...)` | ูู ุชุดููุฑ ูุงูุชุญูู ูู ุงูุจูุงูุงุช ุงููุดูุฑุฉ ุจูุงุณุทุฉ `hsc_aead_encrypt`. |

### ุงูุชุดููุฑ ุงููุชุฏูู (ูุชูุงุซูุ ูููููุงุช ุงููุจูุฑุฉ)
| ุงูุฏุงูุฉ | ุงููุตู |
| :--- | :--- |
| `hsc_crypto_stream_state* hsc_crypto_stream_state_new_push(...)` | ุฅูุดุงุก ูุงุฆู ุญุงูุฉ ูุชุฏูู ุงูุชุดููุฑ. |
| `hsc_crypto_stream_state* hsc_crypto_stream_state_new_pull(...)` | ุฅูุดุงุก ูุงุฆู ุญุงูุฉ ูุชุฏูู ูู ุงูุชุดููุฑ. |
| `int hsc_crypto_stream_push(...)` | ุชุดููุฑ ูุชูุฉ ุจูุงูุงุช ูุงุญุฏุฉ ูู ุงูุชุฏูู. |
| `int hsc_crypto_stream_pull(...)` | ูู ุชุดููุฑ ูุชูุฉ ุจูุงูุงุช ูุงุญุฏุฉ ูู ุงูุชุฏูู. |
| `void hsc_crypto_stream_state_free(hsc_crypto_stream_state** state)` | ุชุญุฑูุฑ ูุงุฆู ุญุงูุฉ ุงูุชุฏูู. |

### ุงูุฐุงูุฑุฉ ุงูุขููุฉ
| ุงูุฏุงูุฉ | ุงููุตู |
| :--- | :--- |
| `void* hsc_secure_alloc(size_t size)` | ุชุฎุตูุต ูุชูุฉ ุฐุงูุฑุฉ ูุญููุฉ ูุบูุฑ ูุงุจูุฉ ูููุจุงุฏูุฉ. |
| `void hsc_secure_free(void* ptr)` | ูุณุญ ูุชุญุฑูุฑ ุงูุฐุงูุฑุฉ ุงููุญููุฉ ุจุฃูุงู. |


## 9. ๐ฅณ ุงููุณุงููุฉ

ูุฑุญุจ ุจุฌููุน ุฃุดูุงู ุงููุณุงููุฉ! ุฅุฐุง ูุฌุฏุช ุฎุทุฃูุ ุฃู ูุฏูู ุงูุชุฑุงุญ ูููุฒุฉุ ุฃู ุชุฑุบุจ ูู ุชุญุณูู ุงูุชูุซููุ ููุง ุชุชุฑุฏุฏ ูู ุฅุฑุณุงู ุทูุจ ุณุญุจ (Pull Request) ุฃู ุฅูุดุงุก ูุถูุฉ (Issue).

## 10. ๐ฅบ ูุตู ุงูุดูุงุฏุฉ (Certificate Description)

ูุณุชุฎุฏู ูุฐุง ุงููุดุฑูุน ูุธุงู ุดูุงุฏุงุช **X.509 v3** ูุฑุจุท ููุชุงุญ ุนุงู ุจูููุฉ ูุณุชุฎุฏู (ูุซู `alice@example.com`)ุ ูุจุงูุชุงูู ุฅูุดุงุก ุงูุซูุฉ. ุชุชุถูู ุนูููุฉ ุงูุชุญูู ูู ุงูุดูุงุฏุฉ **ุงูุชุญูู ูู ุณูุณูุฉ ุงูุชูุงููุน**ุ ู**ุงูุชุญูู ูู ูุชุฑุฉ ุงูุตูุงุญูุฉ**ุ ู**ูุทุงุจูุฉ ูููุฉ ุงูููุถูุน**ุ ู**ุงูุชุญูู ูู ุญุงูุฉ ุงูุฅูุบุงุก (OCSP)**ุ ูุน ุชุจูู ุณูุงุณุฉ "ุงูุฅุบูุงู ุนูุฏ ุงููุดู" ุงูุตุงุฑูุฉ.

## 11. ๐ฅธ ุงูุชุฑุฎูุต (License) - ูููุฐุฌ ุงูุชุฑุฎูุต ุงููุฒุฏูุฌ

ูุชุจูู ูุฐุง ุงููุดุฑูุน ูููุฐุฌ **ุงูุชุฑุฎูุต ุงููุฒุฏูุฌ (Dual-License)**:

### 1. ุฑุฎุตุฉ GNU Affero ุงูุนุงูุฉ ุงูุนููููุฉ v3.0 (AGPLv3)
ููุงุณุจุฉ ูููุดุงุฑูุน ููุชูุญุฉ ุงููุตุฏุฑุ ูุงูุจุญูุซ ุงูุฃูุงุฏูููุฉุ ูุงูุชุนูู ุงูุดุฎุตู. ุชุชุทูุจ ุฃู ุฃู ุฃุนูุงู ูุดุชูุฉ ูุนุฏูุฉ ุฃู ูุชุงุญุฉ ุนุจุฑ ุดุจูุฉ ูุฌุจ ุฃูุถูุง ุฃู ุชูุชุญ ููุฏูุง ุงููุตุฏุฑู ุจุงููุงูู ุจููุฌุจ AGPLv3.

### 2. ุงูุชุฑุฎูุต ุงูุชุฌุงุฑู (Commercial License)
ููุงุณุจ ูุฃู ุชุทุจููุงุช ุฃู ููุชุฌุงุช ุฃู ุฎุฏูุงุช ุชุฌุงุฑูุฉ ูุบููุฉ ุงููุตุฏุฑ. ุฅุฐุง ููุช ูุง ุชุฑุบุจ ูู ุงูุงูุชุฒุงู ุจุดุฑูุท ุงููุตุฏุฑ ุงูููุชูุญ ูู AGPLv3ุ ููุฌุจ ุนููู ุงูุญุตูู ุนูู ุชุฑุฎูุต ุชุฌุงุฑู.

**ููุญุตูู ุนูู ุชุฑุฎูุต ุชุฌุงุฑูุ ูุฑุฌู ุงูุชูุงุตู ุนุจุฑ: `eldric520lol@gmail.com`**

</div>